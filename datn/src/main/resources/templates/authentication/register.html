<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Register</title>
    <link href="/css/tailwind.min.css" rel="stylesheet" type="text/css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.3/dist/jquery.validate.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#form-validation').validate({
                ignore: ':hidden:not(:checkbox)',
                errorElement: 'div',
                errorClass: 'input-invalid',
                validClass: 'input-valid',
                errorPlacement: function (error, element) {
                    error.addClass('text-red-600 mt-1');
                    if (element.prop('type') === 'checkbox') {
                        error.insertAfter(element.parent('label'));
                    } else {
                        error.insertAfter(element);
                    }
                },
                rules: {
                    username: {
                        required: true,
                    },
                    email: {
                        required: true,
                        email: true
                    },
                    sdt: {
                        required: true,
                        digits: true,
                        minlength: 10,
                        maxlength: 11
                    },
                    password: {
                        required: true,
                        minlength: 6
                    },
                    gioiTinh: {
                        required: true
                    },
                    ngaySinh: {
                        required: true,
                        date: true
                    },
                    diaChi: {
                        required: true
                    },
                    xa: {
                        required: true
                    },
                    huyen: {
                        required: true
                    },
                    thanhPho: {
                        required: true
                    },
                    diaChiSdt: {
                        required: true,
                        digits: true,
                        minlength: 10,
                        maxlength: 11
                    },
                    diaChiTen: {
                        required: true
                    },
                    acceptTerms: {
                        required: true
                    }
                },
                messages: {
                    username: {
                        required: 'Vui lòng nhập tên đăng nhập',
                    },
                    email: {
                        required: 'Vui lòng nhập email',
                        email: 'Email không đúng định dạng'
                    },
                    sdt: {
                        required: 'Vui lòng nhập số điện thoại',
                        digits: 'Số điện thoại phải là chữ số',
                        minlength: 'Số điện thoại phải có ít nhất 10 chữ số',
                        maxlength: 'Số điện thoại không được quá 11 chữ số'
                    },
                    password: {
                        required: 'Vui lòng nhập mật khẩu',
                        minlength: 'Mật khẩu phải có ít nhất 6 ký tự'
                    },
                    gioiTinh: {
                        required: 'Vui lòng chọn giới tính'
                    },
                    ngaySinh: {
                        required: 'Vui lòng nhập ngày sinh',
                        date: 'Ngày sinh không đúng định dạng'
                    },
                    diaChi: {
                        required: 'Vui lòng nhập địa chỉ'
                    },
                    xa: {
                        required: 'Vui lòng nhập xã'
                    },
                    huyen: {
                        required: 'Vui lòng nhập huyện'
                    },
                    thanhPho: {
                        required: 'Vui lòng nhập thành phố'
                    },
                    diaChiSdt: {
                        required: 'Vui lòng nhập số điện thoại liên hệ tại địa chỉ',
                        digits: 'Số điện thoại phải là chữ số',
                        minlength: 'Số điện thoại phải có ít nhất 10 chữ số',
                        maxlength: 'Số điện thoại không được quá 11 chữ số'
                    },
                    diaChiTen: {
                        required: 'Vui lòng nhập tên người liên hệ tại địa chỉ'
                    },
                    acceptTerms: {
                        required: 'Vui lòng chấp nhận điều khoản'
                    }
                }
            });
        });
    </script>

</head>
<body>
<section
        class="md:h-screen py-36 flex items-center bg-orange-500/10 dark:bg-orange-500/20 bg-[url('../..//images/hero/bg-shape.html')] bg-center bg-no-repeat bg-cover">
    <div class="container relative">
        <div class="grid grid-cols-1">
            <div class="relative overflow-hidden rounded-md shadow dark:shadow-gray-700 bg-white dark:bg-slate-900">
                <div class="grid md:grid-cols-2 grid-cols-1 items-center">
                    <div class="relative md:shrink-0">
                        <img class="h-full w-full object-cover md:h-[44rem]" src="/images/signup.jpg" alt="">
                    </div>
                    <div class="p-8 lg:px-20">
                        <div class="text-center">
                            <a>
                                <img src="/images/logo_xboy.png" class="h-[75px] mx-auto block" alt="">
                            </a>
                        </div>
                        <form th:action="@{/signup}" method="post" id="form-validation">
                            <div class="grid grid-cols-1">
                                <div th:if="${error}" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
                                    <span class="block sm:inline" th:text="${error}"></span>
                                </div>

                                <!-- Fields on the same row -->
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                    <div class="mb-4">
                                        <label class="font-semibold">Tên Khách Hàng</label>
                                        <input type="text" name="username" class="mt-3 w-full py-2 px-3 h-10" placeholder="Tên Khách Hàng">
                                    </div>

                                    <div class="mb-4">
                                        <label class="font-semibold">Ngày Sinh</label>
                                        <input type="date" name="ngaySinh" class="mt-3 w-full py-2 px-3 h-10">
                                    </div>

                                    <div class="mb-4">
                                        <label class="font-semibold">Email</label>
                                        <input type="email" name="email" class="mt-3 w-full py-2 px-3 h-10" placeholder="name@example.com">
                                        <div th:if="${emailError}" class="error-message">
                                            <p th:text="${emailError}"></p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Số điện thoại -->
                                <div class="grid grid-cols-1 gap-4 mb-4">
                                    <div class="mb-4">
                                        <label class="font-semibold">Số điện thoại</label>
                                        <input type="text" name="sdt" class="mt-3 w-full py-2 px-3 h-10" placeholder="Số điện thoại">
                                        <div th:if="${phoneError}" class="error-message">
                                            <p th:text="${phoneError}"></p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Giới tính -->
                                <div class="mb-4 col-span-2 lg:col-span-1">
                                    <label class="font-semibold">Giới tính</label>
                                    <div class="flex items-center" style="gap: 20px;"> <!-- Sử dụng gap để tạo khoảng cách -->
                                        <label>
                                            <input type="radio" name="gioiTinh" value="false" class="mr-2" checked> Nữ <!-- Thêm thuộc tính checked -->
                                        </label>
                                        <label>
                                            <input type="radio" name="gioiTinh" value="true" class="mr-2"> Nam
                                        </label>
                                    </div>
                                </div>


                                <!-- Thành phố, Huyện, Xã -->
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                    <div>
                                        <label class="font-semibold">Thành phố</label>
                                        <select name="thanhPho" id="province" class="w-full py-2 px-3 h-10 bg-transparent border">
                                            <option value="">Chọn Thành phố</option>
                                            <!-- Dữ liệu sẽ được nạp động -->
                                        </select>
                                    </div>
                                    <div>
                                        <label class="font-semibold">Huyện</label>
                                        <select name="huyen" id="district" class="w-full py-2 px-3 h-10 bg-transparent border" disabled>
                                            <option value="">Chọn Huyện</option>
                                            <!-- Dữ liệu sẽ được nạp động -->
                                        </select>
                                    </div>
                                    <div>
                                        <label class="font-semibold">Xã</label>
                                        <select name="xa" id="ward" class="w-full py-2 px-3 h-10 bg-transparent border" disabled>
                                            <option value="">Chọn Xã</option>
                                            <!-- Dữ liệu sẽ được nạp động -->
                                        </select>
                                    </div>
                                </div>

                                <!-- Địa Chỉ và Số điện thoại người nhận -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div class="mb-4">
                                        <label class="font-semibold">Địa Chỉ</label>
                                        <input type="text" name="diaChi"
                                               class="w-full py-2 px-3 h-10 bg-transparent dark:bg-slate-900 dark:text-slate-200 rounded outline-none border border-gray-100 dark:border-gray-800 focus:ring-0 mt-2"
                                               placeholder="Địa Chỉ">
                                    </div>
                                    <div class="mb-4">
                                        <label class="font-semibold">Số điện thoại người nhận</label>
                                        <input type="text" name="diaChiSdt"
                                               class="w-full py-2 px-3 h-10 bg-transparent dark:bg-slate-900 dark:text-slate-200 rounded outline-none border border-gray-100 dark:border-gray-800 focus:ring-0 mt-2"
                                               placeholder="Số điện thoại người nhận">
                                    </div>
                                </div>

                                <div class="mb-4">
                                    <label class="font-semibold">Tên người nhận</label>
                                    <input type="text" name="diaChiTen"
                                           class="w-full py-2 px-3 h-10 bg-transparent dark:bg-slate-900 dark:text-slate-200 rounded outline-none border border-gray-100 dark:border-gray-800 focus:ring-0 mt-2"
                                           placeholder="Tên người nhận">
                                </div>

                                <!-- Mật khẩu -->
                                <div class="mb-4">
                                    <label class="font-semibold">Mật Khẩu</label>
                                    <input type="password" name="password" class="mt-3 w-full py-2 px-3 h-10" placeholder="Password">
                                </div>

                                <div class="mb-4">
                                    <div class="flex items-center w-full mb-0">
                                        <input class="form-checkbox rounded border-gray-100 dark:border-gray-800 text-orange-500 focus:border-orange-300 focus:ring focus:ring-offset-0 focus:ring-orange-200 focus:ring-opacity-50 me-2"
                                               type="checkbox" name="acceptTerms" id="AcceptT&C">
                                        <label class="text-sm text-gray-700 dark:text-slate-200" for="AcceptT&C">Tôi đồng ý với các <a href="#" class="text-orange-500">Điều khoản dịch vụ</a> và <a href="#" class="text-orange-500">Chính sách bảo mật</a></label>
                                    </div>
                                </div>

                                <div class="mb-4">
                                    <input type="submit" class="w-full py-3 px-6 bg-orange-500 hover:bg-orange-600 text-white rounded shadow hover:shadow-lg transition duration-150 ease-in-out"
                                           value="Đăng ký">
                                </div>
                                <div class="mt-4 text-center">
                                    <p class="text-sm text-slate-500">Bạn đã có tài khoản? <a class="text-orange-500" href="/loginUser">Đăng nhập</a></p>
                                </div>
                            </div>
                        </form>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
</body>
</html>

<script>
    $(document).ready(function () {
        function getProvinces() {
            $.ajax({
                url: 'https://online-gateway.ghn.vn/shiip/public-api/master-data/province',
                type: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'Token': 'c00660e2-2e4f-11ef-8f55-4ee3d82283af'
                },
                success: function (response) {
                    if (response.code === 200) {
                        $("#province").append('<option value="">Chọn Thành phố</option>');
                        $.each(response.data, function (key, value) {
                            $("#province").append('<option value="' + value.ProvinceID + '">' + value.ProvinceName + '</option>');
                        });
                    } else {
                        console.error('Error fetching provinces:', response.message);
                    }
                },
                error: function (xhr, status, error) {
                    console.error('AJAX error:', status, error);
                    console.error('Response text:', xhr.responseText);
                }
            });
        }

        function getDistricts(provinceId) {
            $.ajax({
                url: 'https://online-gateway.ghn.vn/shiip/public-api/master-data/district?province_id=' + provinceId,
                type: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'Token': 'c00660e2-2e4f-11ef-8f55-4ee3d82283af'
                },
                success: function (response) {
                    if (response.code === 200) {
                        $("#district").html('<option value="">Chọn Huyện</option>');
                        $("#ward").html('<option value="">Chọn Xã</option>');
                        $.each(response.data, function (key, value) {
                            $("#district").append('<option value="' + value.DistrictID + '">' + value.DistrictName + '</option>');
                        });
                        $("#district").prop('disabled', false); // Kích hoạt dropdown huyện
                    } else {
                        console.error('Error fetching districts:', response.message);
                    }
                },
                error: function (xhr, status, error) {
                    console.error('AJAX error:', status, error);
                    console.error('Response text:', xhr.responseText);
                }
            });
        }

        function getWards(districtId) {
            $.ajax({
                url: 'https://online-gateway.ghn.vn/shiip/public-api/master-data/ward?district_id=' + districtId,
                type: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'Token': 'c00660e2-2e4f-11ef-8f55-4ee3d82283af'
                },
                success: function (response) {
                    if (response.code === 200) {
                        $("#ward").html('<option value="">Chọn Xã</option>');
                        $.each(response.data, function (key, value) {
                            $("#ward").append('<option value="' + value.WardCode + '">' + value.WardName + '</option>');
                        });
                        $("#ward").prop('disabled', false); // Kích hoạt dropdown xã
                    } else {
                        console.error('Error fetching wards:', response.message);
                    }
                },
                error: function (xhr, status, error) {
                    console.error('AJAX error:', status, error);
                    console.error('Response text:', xhr.responseText);
                }
            });
        }

        getProvinces();

        $("#province").on('change', function () {
            const provinceId = $(this).val();
            if (provinceId) {
                getDistricts(provinceId);
                $("#district").prop('disabled', true); // Kích hoạt dropdown huyện
                $("#ward").prop('disabled', true); // Kích hoạt dropdown xã
            } else {
                $("#district").html('<option value="">Chọn Huyện</option>');
                $("#ward").html('<option value="">Chọn Xã</option>');
                $("#district").prop('disabled', true);
                $("#ward").prop('disabled', true);
            }
        });

        $("#district").on('change', function () {
            const districtId = $(this).val();
            if (districtId) {
                getWards(districtId);
            } else {
                $("#ward").html('<option value="">Chọn Xã</option>');
                $("#ward").prop('disabled', true); // Kích hoạt dropdown xã
            }
        });
    });
</script>

<style>
    .error-message {
    color: red;
    font-size: 0.875rem; /* 14px */
    margin-top: 0.25rem; /* 4px */
}

</style>

